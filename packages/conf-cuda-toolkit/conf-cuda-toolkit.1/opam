opam-version: "2.0"
maintainer: "Lukasz Stafiniak <lukstafi@gmail.com>"
authors: [ "NVIDIA" ]
homepage: "https://docs.nvidia.com/cuda/"
license: "CUDA Toolkit End User License Agreement"
available: [
  (os = "linux")
]
build: [
  ["sh" "-exc" "echo \"#include  \\\"cuda.h\\\"#include  \\\"nvrtc.h\\\"\\n\" > test.c"]
  ["sh" "-exc" "cc -c $CFLAGS -I/usr/local/cuda/include test.c"]
]
depends: [ "conf-gcc" ]
depexts: [
  # See: https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#meta-packages
  # The meta-package cuda-toolkit should not include drivers,
  # therefore it is typically safe to install both on regular distributions and on WSL.
  # On Arch Linux cuda-toolkit is provided by a cuda package that does include drivers.
  # Unfortunately, the distributions don't include the packages themselves, need to be added
  # depending on the system, e.g.:
  # [sudo dnf config-manager --add-repo | sudo zypper addrepo
  #    https://developer.download.nvidia.com/compute/cuda/repos/$distro/$arch/cuda-$distro.repo]
  # or added to [/etc/apt/sources.list.d/].
  # ["cuda-toolkit"]
]
post-messages: [
  "On some systems cuda-toolkit does not include CUDA drivers. If not on WSL, consider installing cuda-drivers."
  "If the compilation test fails, try linking /usr/local/cuda to your cuda installation directory."
  {failure}
]
synopsis: "Virtual package relying on a cuda-toolkit system installation"
description:
  "This package can only install if cuda-toolkit is installed on the system. cuda-toolkit might not include drivers."
bug-reports: "https://github.com/ocaml/opam-repository/issues"
flags: conf
